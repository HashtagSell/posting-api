FORMAT: 1A

# Postings API
Postings API stores and retrieves postings for HashtagSell and other external sources (commonly retrieved via 3taps).

# Group Version
The version resource is useful for retrieving status and uptime as well as current version for the postings API

## Version [/v1/version]
Postings API version information.

### Get API version [GET]

  + Response 200 (application/json)

    + Body

            {
              "name": "posting-api",
              "version": "0.1.2",
              "memory": {
                "free": "4.97 GB",
                "total": "17.18 GB"
                },
                "os": {
                  "arch": "x64",
                  "hostname": "joshuas-mbp.playnetwork.com"
                  },
                  "uptime": "5 seconds"
                }
              }
            }

# Group Groupings
The groupings resources allow for retrieval of groupings and sub-categories under which postings can be organized.

## Groupings Collection [/v1/groupings/{?start,count,filters,sort}]
Retrieve a paginated, filtered and sorted collection of postings

The groupings collection resource has the following attributes:

- options
- results
- total

+ Model (application/json)

  + Body

            {
              "options": {
                "count": 1000,
                "filters": {},
                "sort": {},
                "start": 0
              },
              "results": [
                {
                  "code": "AAAA",
                  "name": "animals",
                  "categories": [
                    {
                      "code": "APET",
                      "name": "pets"
                    },
                    {
                      "code": "ASUP",
                      "name": "supplies"
                    },
                    {
                      "code": "AOTH",
                      "name": "other"
                    }
                  ]
                },
                /* results abbreviated */
              ],
              "total": 11
            }

### List groupings [GET]

  + Parameters
    + start (optional, number) ... beginning of page to retrieve
    + count (optional, number) ... number of results to retrieve per page
    + filters (optional, object) ... a set of filters for searching
    + sort (optional, object) ... a set of fields and options for sorting the results

  + Response 200

    [Groupings Collection][]

## Groupings [/v1/groupings/{code}]
The groupings resource has the following attributes:

- code
- name
- categories

+ Model (application/json)

  + Body

            {
              "code": "CCCC",
              "name": "community",
              "categories": [
                {
                  "code": "CCNW",
                  "name": "classes and workshops"
                },
                {
                  "code": "COMM",
                  "name": "events"
                },
                {
                  "code": "CGRP",
                  "name": "groups"
                },
                {
                  "code": "CLNF",
                  "name": "lost and found"
                },
                {
                  "code": "CRID",
                  "name": "rideshares"
                },
                {
                  "code": "CVOL",
                  "name": "volunteers"
                },
                {
                  "code": "COTH",
                  "name": "other"
                }
              ]
            }

### Get a grouping [GET]
Retrieve a single grouping

+ Parameters

  + code (string) ... Identifier of the grouping

+ Response 200

  [Groupings][]

# Group Postings
The postings resources allow for search, retrieval, storage and removal of postings

## Postings Collection [/v1/postings/{?start,count,filters,sort,geo,expand}]
Retrieve a paginated, filtered and sorted collection of postings

The Postings Collection resource has the following attributes:

- options
- results
- total

+ Model (application/json)

  + Body

            {
              "options": {
                "count": "10",
                "filters": {},
                "sort": {},
                "start": 0
              },
              "results": [{
                "heading": "Nikon N2000 35mm  Film Camera with Vivitar Macro Zoom Lens,flash and bag",
                "body": "Nikon N2000 35mm  Film Camera with Vivitar Macro Zoom Lens,flash and bag",
                "expires": "2014-12-29T15:19:29.000Z",
                "annotations": {
                  "price": "24.5",
                  "BIN price": "45.0",
                  "address": "Everett,WA,USA",
                  "listingtype": "AuctionWithBIN",
                  "zipcode": "98204"
                },
                "categoryCode": "SELE",
                "postingId": "d15a289f78a545f0a79944c6d6126961",
                "language": "en",
                "images": [{
                  "images": "http://thumbs4.ebaystatic.com/m/mVy-tyGpDwAtfX5djZeqYOA/140.jpg"
                }],
                "geo": {
                  "status": 3,
                  "coordinates": [
                    47.898328,
                    -122.26071
                  ],
                  "accuracy": 8
                },
                "created": "2014-12-15T15:19:29.000Z",
                "askingPrice": {
                  "value": "24.5",
                  "currency": "USD"
                  },
                "external": {
                  "threeTaps": {
                    "timestamp": 1418656769,
                    "status": "for_sale",
                    "categoryGroup": "SSSS",
                    "category": "SELE",
                    "id": 1614251359,
                    "location": {
                      "state": "USA-WA",
                      "region": "USA-SEA-SNO",
                      "metro": "USA-SEA",
                      "locality": "USA-SEA-HOL",
                      "formatted": "98204,Everett,WA,USA",
                      "county": "USA-WA-SNO",
                      "country": "USA",
                      "city": "USA-SEA-EVE"
                    }
                  },
                  "source": {
                    "url": "http://www.ebay.com/itm/Nikon-N2000-35mm-Film-Camera-Vivitar-Macro-Zoom-Lens-flash-and-bag-/321618196579?pt=Film_Cameras",
                    "id": "321618196579",
                    "code": "E_BAY"
                  }
                },
                "username": "brozeph"
              }],
              "total": 440
            }

### List postings [GET]

  + Parameters
    + start = `0` (optional, number) ... beginning of page to retrieve
    + count = `1000` (optional, number) ... number of results to retrieve per page
    + filters (optional, object) ... a set of filters for searching
      Filters are passed in as a bracketed object, i.e. filters[mandatory][exact][field_name_here]=search_term
    + geo (optional, object) ... a set of geo spatial parameters for radius and doughnut style geo search
      Geo params are passed in as a bracketed object, i.e. geo[min]=100&geo[max]=200&geo[coords]=12.944,0.322
    + sort (optional, object) ... a set of fields and options for sorting the results
    + expand = `false` (optional, boolean) ... when true, expands the output to include offers and questions for each item listed

  + Response 200

    [Postings Collection][]

## Postings [/v1/postings/{postingId}]
The posting resource has the following attributes:

- heading
- body
- expires
- annotations
- categoryCode
- postingId
- language
- images
- geo
- created
- askingPrice
- external
- username

+ Model (application/json)

  + Body

            {
              "heading": "Nikon N2000 35mm  Film Camera with Vivitar Macro Zoom Lens,flash and bag",
              "body": "Nikon N2000 35mm  Film Camera with Vivitar Macro Zoom Lens,flash and bag",
              "expires": "2014-12-29T15:19:29.000Z",
              "annotations": {
                "price": "24.5",
                "BIN price": "45.0",
                "address": "Everett,WA,USA",
                "listingtype": "AuctionWithBIN",
                "zipcode": "98204"
              },
              "categoryCode": "SELE",
              "postingId": "d15a289f78a545f0a79944c6d6126961",
              "language": "en",
              "images": [{
                "images": "http://thumbs4.ebaystatic.com/m/mVy-tyGpDwAtfX5djZeqYOA/140.jpg"
              }],
              "geo": {
                "status": 3,
                "coordinates": [
                  47.898328,
                  -122.26071
                ],
                "accuracy": 8
              },
              "created": "2014-12-15T15:19:29.000Z",
              "askingPrice": {
                "value": "24.5",
                "currency": "USD"
              },
              "external": {
                "threeTaps": {
                  "timestamp": 1418656769,
                  "status": "for_sale",
                  "categoryGroup": "SSSS",
                  "category": "SELE",
                  "id": 1614251359,
                  "location": {
                    "state": "USA-WA",
                    "region": "USA-SEA-SNO",
                    "metro": "USA-SEA",
                    "locality": "USA-SEA-HOL",
                    "formatted": "98204,Everett,WA,USA",
                    "county": "USA-WA-SNO",
                    "country": "USA",
                    "city": "USA-SEA-EVE"
                  }
                },
                "source": {
                  "url": "http://www.ebay.com/itm/Nikon-N2000-35mm-Film-Camera-Vivitar-Macro-Zoom-Lens-flash-and-bag-/321618196579?pt=Film_Cameras",
                  "id": "321618196579",
                  "code": "E_BAY"
                }
              },
              "username": "brozeph"
            }

### Get a posting [GET]
Retrieve a single posting

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).

+ Response 200

  [Postings][]

### Create postings [POST]
To create one or more new postings, send JSON with the appropriate values (_note: 3taps JSON payloads are accepted directly and mapped as appropriate within the API_).

+ Request (application/json)

            {
              "heading": "a heading for the posting",
              "body": "body of the posting",
              "expires": "2015/01/31",
              "username": "brozeph"
            }

+ Response 201

  [Postings][]

### Update a posting [PUT]
To update a single posting, send JSON with updated field values for the fields that should be changed. Not all fields must supplied... whatever fields are missing will not be updated in the base document.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).

+ Request (application/json)

            {
              "heading": "an updating heading",
              "body": "an updated body"
              /* any field supplied will be updated as expected */
            }

+ Response 202

  [Postings][]

### Delete a posting [DELETE]

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).

+ Response 204

# Group Offers

## Posting Offers Collection [/v1/postings/{postingId}/offers/{?start,count,filters,sort}]
Retrieve a paginated, filtered and sorted collection of offers specific to a posting

The Offers Collection resource has the following attributes:

- options
- results
- total

+ Model (application/json)

  + Body

            {
              "options": {
                "count": "10",
                "filters": {},
                "sort": {},
                "start": 0
              },
              "results": [{
                  "offerId" : "c35b389b79a545f0a79944c6d6124562",
                  "postingId" : "d15a289f78a545f0a79944c6d6126961",
                  "proposedTimes" : [{
                    "acceptedAt" : "2015-01-31T14:37:00Z",
                    "when" : "2015-02-01T10:00:00Z",
                    "where" : "San Francisco Library"
                  }, {
                    "when" : "2015-02-02T10:00:00Z",
                    "where" : "San Francisco Library"
                  }, {
                    "when" : "2015-02-03T10:00:00Z",
                    "where" : "San Francisco Library"
                  }],
                  "username" : "this1guy",
                  "createdAt" : "2015-02-01T03:33:18Z",
                  "modifiedAt" :"2015-02-01T03:33:18Z"
                }],
              "total": 1
            }

### List offers for posting [GET]

+ Parameters
  + postingId (required, string) ... the posting for which offers should be loaded
  + start (optional, number) ... beginning of page to retrieve
  + count (optional, number) ... number of results to retrieve per page
  + filters (optional, object) ... a set of filters for searching
  + sort (optional, object) ... a set of fields and options for sorting the results

+ Response 200

  [Posting Offers Collection][]

## Offers [/v1/postings/{postingId}/offers/{offerId}]
The offer resource has the following attributes:

- offerId
- postingId
- proposedTimes
- username
- createdAt
- modifiedAt

+ Model (application/json)

  + Body

            {
              "offerId" : "c35b389b79a545f0a79944c6d6124562",
              "postingId" : "d15a289f78a545f0a79944c6d6126961",
              "proposedTimes" : [{
                "acceptedAt" : "2015-01-31T14:37:00Z",
                "when" : "2015-02-01T10:00:00Z",
                "where" : "San Francisco Library"
              }, {
                "when" : "2015-02-02T10:00:00Z",
                "where" : "San Francisco Library"
              }, {
                "when" : "2015-02-03T10:00:00Z",
                "where" : "San Francisco Library"
              }],
              "username" : "this1guy",
              "createdAt" : "2015-02-01T03:33:18Z",
              "modifiedAt" : "2015-02-01T03:33:18Z"
            }

### Get an offer [GET]
Retrieve a single offer

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + offerId (string) ... Identifier of the offer

+ Response 200

  [Offers][]

### Create offers [POST]
To create an offer, send JSON with the appropriate values.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).

+ Request (application/json)

            {
              "proposedTimes": [{
                "when" : "2015-02-01T10:00:00Z",
                "where" : "San Francisco Library"
              }],
              "username": "brozeph"
            }

+ Response 201

  [Offers][]

### Update an offer [PUT]
To update a single offer, send JSON with updated field values for the fields that should be changed. Not all fields must supplied... whatever fields are missing will not be updated in the base document. Additionally, for the proposedTimes parameter array, the entire array must be specified if it is being modified.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + offerId (string) ... Identifier of the offer

+ Request (application/json)

            {
              "proposedTimes": [{
                "when" : "2015-02-01T10:00:00Z",
                "where" : "San Francisco Library"
              }, {
                "when" : "2015-02-02T10:00:00Z",
                "where" : "San Francisco Library"
              }],
              "username": "brozeph"
            }

+ Response 202

  [Offers][]

### Delete an offer [DELETE]

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + offerId (string) ... Identifier of the offer

+ Response 204

## Accept Offers [/v1/postings/{postingId}/offers/{offerId}/accept]
Accept a proposed time from a single offer

The accept offer resource has the following attributes:

- when
- where

+ Model (application/json)

  + Body

            {
              "acceptedAt" : "2015-01-30T11:24:17Z",
              "when" : "2015-02-01T10:00:00Z",
              "where" : "San Francisco Library"
            }

### Accept an offer [POST]
To accept a proposed time for an offer, send JSON with the when and where fields.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + offerId (string) ... Identifier of the offer

+ Request (application/json)

            {
              "when" : "2015-02-01T10:00:00Z",
              "where" : "San Francisco Library"
            }

+ Response 201

  [Accept Offers][]

# Group Questions

## Posting Questions Collection [/v1/postings/{postingId}/questions/{?start,count,filters,sort}]
Retrieve a paginated, filtered and sorted collection of questions specific to a posting

The Questions Collection resource has the following attributes:

- options
- results
- total

+ Model (application/json)

  + Body

            {
              "options": {
                "count": "10",
                "filters": {},
                "sort": {},
                "start": 0
              },
              "results": [{
                "questionId" : "c35b389b79a545f0a79944c6d6124562",
                "postingId" : "d15a289f78a545f0a79944c6d6126961",
                "answers" : [{
                  "answerId" : "a75b389b79a545f0a79944c6d6124584",
                  "createdAt" : "2015-02-07T17:11:08Z",
                  "username" : "brozeph",
                  "value" : "Yes, it does."
                }],
                "plus" : [{
                  "createdAt" : "2015-02-06T08:17:54Z",
                  "username" : "this1guy"
                }],
                "username" : "someOtherGuy",
                "value" : "Does the automobile have leather upholstery?",
                "createdAt" : "2015-02-05T03:33:18Z",
                "modifiedAt" : "2015-02-07T17:11:08Z"
              }],
              "total": 1
            }

### List questions [GET]

+ Parameters
  + postingId (required, string) ... the posting for which questions should be loaded  
  + start (optional, number) ... beginning of page to retrieve
  + count (optional, number) ... number of results to retrieve per page
  + filters (optional, object) ... a set of filters for searching
  + sort (optional, object) ... a set of fields and options for sorting the results

+ Response 200

  [Posting Questions Collection][]

## User Questions Collection [/v1/users/{username}/questions/{?start,count,filters,sort}]
Retrieve a paginated, filtered and sorted collection of questions specific to a user

The Questions Collection resource has the following attributes:

- options
- results
- total

+ Model (application/json)

  + Body

            {
              "options": {
                "count": "10",
                "filters": {},
                "sort": {},
                "start": 0
              },
              "results": [{
                "questionId" : "c35b389b79a545f0a79944c6d6124562",
                "postingId" : "d15a289f78a545f0a79944c6d6126961",
                "answers" : [{
                  "answerId" : "a75b389b79a545f0a79944c6d6124584",
                  "createdAt" : "2015-02-07T17:11:08Z",
                  "username" : "brozeph",
                  "value" : "Yes, it does."
                }],
                "plus" : [{
                  "createdAt" : "2015-02-06T08:17:54Z",
                  "username" : "this1guy"
                }],
                "username" : "someOtherGuy",
                "value" : "Does the automobile have leather upholstery?",
                "createdAt" : "2015-02-05T03:33:18Z",
                "modifiedAt" : "2015-02-07T17:11:08Z"
              }],
              "total": 1
            }

### List user questions [GET]

+ Parameters
  + username (required, string) ... the user for which questions should be loaded  
  + start (optional, number) ... beginning of page to retrieve
  + count (optional, number) ... number of results to retrieve per page
  + filters (optional, object) ... a set of filters for searching
  + sort (optional, object) ... a set of fields and options for sorting the results

+ Response 200

  [User Questions Collection][]

## Questions [/v1/postings/{postingId}/questions/{questionId}]

The question resource has the following attributes:

- questionId
- postingId
- answers
- plus
- username
- value
- createdAt
- modifiedAt

+ Model (application/json)

  + Body

            {
              "questionId" : "c35b389b79a545f0a79944c6d6124562",
              "postingId" : "d15a289f78a545f0a79944c6d6126961",
              "answers" : [{
                "answerId" : "a75b389b79a545f0a79944c6d6124584",
                "createdAt" : "2015-02-07T17:11:08Z",
                "username" : "brozeph",
                "value" : "Yes, it does."
              }],
              "plus" : [{
                "createdAt" : "2015-02-06T08:17:54Z",
                "username" : "this1guy"
              }],
              "username" : "someOtherGuy",
              "value" : "Does the automobile have leather upholstery?",
              "createdAt" : "2015-02-05T03:33:18Z",
              "modifiedAt" : "2015-02-07T17:11:08Z"
            }

### Get a question [GET]
Retrieve a single question

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + questionId (string) ... Identifier of the question

+ Response 200

  [Questions][]

### Create questions [POST]
To create a question, send JSON with the appropriate values.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).

+ Request (application/json)

            {
              "username" : "someOtherGuy",
              "value" : "Are the seats leather?"
            }

+ Response 201

  [Questions][]

### Update a question [PUT]
To update a single question, send JSON with updated field values for the fields that should be changed. Not all fields must supplied... whatever fields are missing will not be updated in the base document. Note when modifying an array (answers or plus), supply the entire array in the request to avoid loss of data or omit the fields entirely on the request to leave them unchanged.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + questionId (string) ... Identifier of the question

+ Request (application/json)

            {
              "username" : "someOtherGuy",
              "value" : "Does the automobile have leather upholstery?"
            }

+ Response 202

  [Questions][]

### Delete a question [DELETE]

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + questionId (string) ... Identifier of the question

+ Response 204

# Group Answers

## Answers [/v1/postings/{postingId}/questions/{questionId}/answers/{answerId}]
The answer resource has the following attributes:

- answerId
- createdAt
- username
- value

+ Model (application/json)

  + Body

            {
              "answerId" : "a75b389b79a545f0a79944c6d6124584",
              "createdAt" : "2015-02-07T14:53:22Z",
              "username" : "brozeph",
              "value" : "Yes, it does."
            }

### Answer a question [POST]
To create an answer to a question, send JSON with the appropriate values.

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + questionId (string) ... Identifer of the question for which the answer applies

+ Request (application/json)

            {
              "username" : "someOtherGuy",
              "value" : "Yes, it does."
            }

+ Response 201

  [Answers][]

### Delete an answer [DELETE]

+ Parameters

  + postingId (string) ... Identifier of the posting or a URI for an external id related to the posting. This value may be supplied as an identifer (which will will result in a lookup using the HashtagSell posting ID) or it may be supplied in the format `source:external_id`. Source may be `3taps` or a 3taps source code (i.e. `E_BAY`, `CRAIG`, etc.).
  + questionId (string) ... Identifier of the question
  + answerId (string) ... Identifier of the answer

+ Response 204
